Hundreds of thousands thronged the streets of Cairo and cities around the country Sunday and marched on the presidential palace, filling a broad avenue for blocks, in an attempt to force out the Islamist president with the most massive protests Egypt has seen in 2 1/2 years of turmoil. In a sign of the explosive volatility of the country?s divisions, a hard core of young opponents broke away from the rallies and attacked the main headquarters of President Mohammed Morsi?s Muslim Brotherhood, pelting it with stones and firebombs until a raging fire erupted in the walled villa. During clashes, Brotherhood supporters opened fire with birdshot on the attackers, who swelled to a crowd of hundreds. At least four people were killed Sunday in shootings at anti-Morsi protesters in southern Egypt. Fears were widespread that the two sides could be heading to a violent collision in coming days. Morsi made clear through a spokesman that he would not step down and his Islamist supporters vowed not to allow protesters to remove one of their own, brought to office in a legitimate vote. Thousands of Islamists massed not far from the presidential palace in support of Morsi, some of them prepared for a fight with makeshift armor and sticks. The protesters aimed to show by sheer numbers that the country has irrevocably turned against Morsi, a year to the day after he was inaugurated as Egypt?s first freely elected president. But throughout the day and even up to midnight at the main rallying sites, fears of rampant violence did not materialize. Instead the mood was largely festive as protesters at giant anti-Morsi rallies in Cairo?s central Tahrir Square and outside the Ittihadiya palace spilled into side streets and across boulevards, waving flags, blowing whistles and chanting. Fireworks went off overhead. Men and women, some with small children on their shoulders, beat drums, danced and sang, ?By hook or by crook, we will bring Morsi down.? Residents in nearby homes showered water on marchers below ? some carrying tents in preparation to camp outside the palace ? to cool them in the summer heat, and blew whistles and waved flags in support. ?Mubarak took only 18 days although he had behind him the security, intelligence and a large sector of Egyptians,? said Amr Tawfeeq, an oil company employee marching toward Ittihadiya with a Christian friend. Morsi ?won?t take long. We want him out and we are ready to pay the price.? The massive outpouring against Morsi, culminating a year of growing polarization, raises the question of what is next. Protesters have vowed to stay on the streets until he steps down, and organizers called for widespread labor strikes starting Monday. The president, in turn, appears to be hoping protests wane. For weeks, Morsi?s supporters have depicted the planned protest as a plot by Mubarak loyalists. But their claims were undermined by the extent of Sunday?s rallies. In Cairo and a string of cities in the Nile Delta and on the Mediterranean coast, the protests topped even the biggest protests of the 2011?s 18-day uprising, including the day Mubarak quit, Feb. 11, when giant crowds marched on Ittihadiya. It is unclear now whether the opposition, which for months has demanded Morsi form a national unity government, would now accept any concessions short of his removal. The anticipated deadlock raises the question of whether the army, already deployed on the outskirts of cities, will intervene. Protesters believe the military would throw its significant weight behind them, tipping the balance against Morsi. The country?s police, meanwhile, were hardly to be seen Sunday. ?If the Brothers think that we will give up and leave, they are mistaken,? said lawyer Hossam Muhareb as he sat with a friend on a sidewalk near the presidential palace. ?They will give up and leave after seeing our numbers.? Violence could send the situation spinning into explosive directions. In a potentially volatile confrontation after nightfall, several dozen youths attacked the Muslim Brotherhood?s headquarters on a plateau overlooking the capital. They threw rocks and firebombs at the walled villa, and people inside fired at the attackers with birdshot, according to an Associated Press Television News cameraman at the scene. Southern Egypt saw deadly attacks on anti-Morsi protests, and four people were killed. A protester was shot to death in Beni Suef outside the offices of the Brotherhood?s Freedom and Justice Party. In the city of Assiut, gunmen on a motorcycle opened fire on a protest, killing one person and wounding four others. The enraged protesters then marched on the nearby Freedom and Justice offices, where gunmen inside opened fire, killing two more, security officials said, speaking on condition of anonymity because they weren?t authorized to talk to the press. Clashes erupted, with protesters and security forces fighting side by side against Morsi?s supporters. At least 400 people were injured nationwide, the Health Ministry said. Morsi, who has three years left in his term, said street protests cannot be used to overturn the results of a free election. ?There is no room for any talk against this constitutional legitimacy,? he told Britain?s The Guardian newspaper in an interview published Sunday, rejecting early elections. If an elected president is forced out, ?there will be people or opponents opposing the new president too, and a week or a month later, they will ask him to step down,? he said. Morsi was not at Ittihadiya as Sunday?s rally took place ? he had moved to another nearby palace. As the crowds massed, Morsi?s spokesman Ihab Fahmi repeated the president?s longstanding offer of dialogue with the opposition to resolve the nation?s political crisis, calling it ?the only framework through which we can reach understandings.? The opposition has repeatedly turned down his offers for dialogue, arguing that they were for show. Near Ittihadiya palace, thousands of Islamists gathered in a show of support for Morsi outside the Rabia al-Adawiya mosque. Some Morsi backers wore homemade body armor and construction helmets and carried shields and clubs ? precautions, they said, against possible violence. The demonstrations are the culmination of polarization and instability that have been building since Morsi?s June 30, 2012, inauguration. The past year has seen multiple political crises, bouts of bloody clashes and a steadily worsening economy, with power outages, fuel shortages, rising prices and persistent lawlessness and crime. In one camp are the president and his Islamist allies, including the Muslim Brotherhood and more hard-line groups. Morsi supporters accuse Mubarak loyalists of being behind the protests, aiming to overturn last year?s election results, just as they argue that remnants of the old regime have sabotaged Morsi?s attempts to deal with the nation?s woes and bring reforms. Hard-liners among them have also given the confrontation a sharply religious tone, denouncing Morsi?s opponents as ?enemies of God? and infidels. On the other side is an array of secular and liberal Egyptians, moderate Muslims, Christians ? and what the opposition says is a broad sector of the general public that has turned against the Islamists. They say the Islamists have negated their election mandate by trying to monopolize power, infusing government with their supporters, forcing through a constitution they largely wrote and giving religious extremists a free hand, all while failing to manage the country. ?The country is only going backward. He?s embarrassing us and making people hate Islam,? said Donia Rashad, a 24-year-old unemployed woman who wears the conservative Islamic headscarf. ?We need someone who can feel the people and is agreeable to the majority.? As they marched toward the presidential palace, some chanted, ?You lied to us in the name of religion,? and others raised a banner proclaiming, ?Morsi equals Mubarak. Early presidential elections.? The crowds, including women, children and elderly people, hoisted long banners in the colors of the Egyptian flag and raised red cards ? a sign of expulsion in soccer. In Tahrir, chants of ?erhal!?, or ?leave!? thundered around the square. The crowd, which appeared to number some 300,000, waved Egyptian flags and posters of Morsi with a red X over his face. They whistled and waved when military helicopters swooped close overhead, reflecting their belief that the army favors them over Morsi. A week ago, with the public sense of worry growing over the upcoming confrontation, Defense Minister Gen. Abdel-Fattah el-Sissi demanded the president and his opponents reach a compromise. He warned that the military would intervene to prevent the nation from entering a ?dark tunnel.? Army troops backed by armored vehicles were deployed Sunday in some of Cairo?s suburbs, with soldiers at traffic lights and major intersections. In the evening, they deployed near the international airport, state TV said. Similarly sized crowds turned out in the Mediterranean city of Alexandria and the Nile Delta cities of Mansoura, Tanta and Damanhour, with sizeable rallies in cities nationwide. ?Today is the Brotherhood?s last day in power,? Suliman Mohammed, a manager of a seafood company, said in Tahrir. The opposition protests emerge from a petition campaign by a youth activist group known as Tamarod, Arabic for ?Rebel.? For several months, the group has been collecting signatures on a call for Morsi to step down. On Saturday, the group announced it had more than 22 million signatures ? proof, it claims, that a broad sector of the public no longer wants Morsi in office. It was not possible to verify the claim. If true, it would be nearly twice the some 13 million people who voted for Morsi in last year?s presidential run-off election, which he won with around 52 percent of the vote. Tamarod organizers said they discarded about 100,000 signed forms because they were duplicates. Morsi?s supporters have questioned the authenticity and validity of the signatures, but have produced no evidence of fraud. At the pro-Morsi rally at the Rabia al-Adawiya mosque, the crowd chanted, ?God is great,? and some held up copies of Islam?s holy book, the Quran. ?The people hold the legitimacy and we support Dr. Mohamed Morsi,? said Ahmed Ramadan, one of the rally participants. ?We would like to tell him not to be affected by the opponents? protests and not to give up his rights. We are here to support and protect him.? One of the world?s most prominent Muslim clerics, Sheik Yousef El-Qaradawi, who is close to the Brotherhood, appealed to Egyptians to give Morsi a chance, saying if Morsi goes, ?someone who?s worse than Morsi? would replace him. ?It?s not easy to change a president with another one, but it?s better to correct him,? el-Qaradawi, an Egyptian who has lived in Qatar for many years, said on Al-Jazeera Mubasher Misr TV. Ibrahim Ahmed, a 59-year-old retired civil servant who was at Tahrir with his 5-year-old grandson, Yassin, snorted at the idea. ?He wants us to be patient with Morsi? No, thank you. Look at what happened in one year. The Egyptian pound is going down and the country is being Brotherhood-ized,? he said. AP reporters Tony G. Gabriel and Mariam Rizk contributed to this report